<h1>2.5 How to install Red Hat + Oracle JVM + WebLogic + Oracle</h1>
<h2>Overview</h2>
<p>This documentation page gives instructions to set up a Bonita BPM platform in a specific environment. This environment
includes the following sets of components:</p>
<ul>
<li>Operating System: Red Hat Enterprise Linux 6 Server (RHEL)</li>
<li>Java Virtual Machine: Oracle JVM 7</li>
<li>Database: Oracle Database 11gR2 (11.2.0.1)</li>
<li>JEE Application Server: Oracle WebLogic server 12c (12.1.2)</li>
</ul>
<h2>Operating System</h2>
<p>No specific configuration is required for RHEL.</p>
<p>Note: you might need to configure a firewall if you want to allow remote connections to the server. You should
probably allow port 7001 for TCP protocol:</p>
<ol>
<li>Go to <strong>System / Administration / Firewall</strong>.</li>
<li>Authenticate with the root user password.</li>
<li>In the left menu, select <strong>Others Ports</strong>.</li>
<li>Click the <em><strong>Add</strong></em> button.</li>
<li>Check <strong>User Defined</strong>.</li>
<li>In <strong>Port / Port Range</strong>, type <code>7001</code>.</li>
<li>In <strong>Protocol</strong>, select <strong>tcp</strong>.</li>
<li>Click the <em><strong>OK</strong></em> button.</li>
<li>Click the <em><strong>Apply</strong></em> button.</li>
<li>Close the window.</li>
</ol>
<h2>Java Virtual Machine</h2>
<p>The instructions below explain how to set up the Oracle Java 7 JDK using the Red Hat official package.</p>
<h3>Prerequisite</h3>
<p>First, you need to add <strong>RHEL EUS Server Supplementary</strong> to your system
<a href="https://access.redhat.com/site/documentation/en-US/Red_Hat_Subscription_Management/1/html/Subscription_Concepts_and_Workflows/index.html">subscriptions</a>.
In fact Oracle Java is provided only in this subscription.</p>
<p>To install Oracle Java JDK:</p>
<ol>
<li>Go to System / Administration / Add/Remove Software.</li>
<li>In the search field, type <code>java-1.7.0-oracle-devel</code>.</li>
<li>Click the <em><strong>Find</strong></em> button.</li>
<li>In the package list, select the latest version of <strong>Oracle Java Development Kit</strong>.</li>
<li>Click the <em><strong>Apply</strong></em> button.</li>
<li>Type your root user password and click the <em><strong>Authenticate</strong></em> button.</li>
<li>You can now close the &quot;Add/Remove Software&quot; window.</li>
</ol>
<h3>Check the Java setup</h3>
<p>To check that Java is correctly set up:</p>
<ol>
<li>Go to <strong>Applications / System Tools / Terminal</strong>.</li>
<li>In the terminal window, type <code>java -version</code>. You should get something like:
<code>java version &quot;1.7.0_15&quot; Java(TM) SE Runtime Environment (build 1.7.0_15-b03) Java HotSpot(TM) 64-Bit Server VM (build 23.7-b01, mixed mode)</code></li>
</ol>
<h2>Database</h2>
<h3>DBMS installation</h3>
<p>Follow the standard Oracle Database installation.</p>
<h3>Create a database user</h3>
<ol>
<li>Execute the following command to create the user:
<code>CREATE USER bonita_db_user IDENTIFIED BY bonita_db_password GRANT connect, resource TO bonita_db_user IDENTIFIED BY bonita_db_password</code></li>
</ol>
<ol start="2">
<li>
<p>Now you will need to perform some specific configuration required by Bonita BPM.
(Usage of transaction (XADataSource) requires extra privileges for the Oracle user used by Bonita BPM).</p>
</li>
<li>
<p>Grant the appropriate privileges to your user with the following operations:
<code>GRANT select ON sys.dba_pending_transactions TO bonita_db_user GRANT select ON sys.pending_trans$ TO bonita_db_user GRANT select ON sys.dba_2pc_pending TO bonita_db_user GRANT execute ON sys.dbms_system TO bonita_db_user</code></p>
</li>
</ol>
<h2>JEE Application Server</h2>
<h3>Setup</h3>
<ol>
<li></li>
</ol>
<p>To set up WebLogic, you need to know the location of the <strong>Java home folder</strong>. If you set up the Red Hat package of
Oracle JDK 7 64 bits, the Java home folder will be:
<code>/usr/lib/jvm/java-1.7.0-oracle-1.7.0.15.x86_64</code>.</p>
<ol start="2">
<li>You just need to follow a standard installation of WebLogic. The Bonita BPM platform doesn't have any specific
needs.</li>
<li>Once the installation of WebLogic is completed, you will need to create a new domain. Make sure you remember the user name
and password, as you will need both later on in the installation guidelines.</li>
<li>At this point you should be able to start WebLogic server and log in to the web administration console. The default address
would be:
<code>http://localhost:7001/console</code>
.</li>
</ol>
<h2>Data source declaration</h2>
<p>Here we will configure data sources that are available at a global scope (all applications deployed). For all Bonita BPM Platform systems, you need two data sources, bonitaDS and bonitaSequenceManagerDS.
If you are using <a href="/business-data-model-856">business data</a>, you need two additional data sources, BusinessDataDS and NotManagedBizDataDS.</p>
<h3>bonitaDS and BusinessDataDS</h3>
<p>Follow this procedure to configure the bonitaDS datasource, and (optionally) again to configure the BusinessDataDS data source.</p>
<ol>
<li>Connect to <strong>WebLogic administration console</strong>.</li>
<li>In the tree menu on the left, go to <strong>Services / Data Sources</strong>.</li>
<li>Click New and select <strong>Generic Data Sources</strong>.</li>
<li>Set</li>
</ol>
<ul>
<li>The data source name: bonitaDS (or BusinessDataDS)</li>
<li>JDNI name: bonitaDS (or BusinessDataDS)</li>
<li>Database type: Oracle</li>
</ul>
<ol start="5">
<li>Click <em><strong>Next</strong></em>.</li>
<li>Select <strong>Oracle Driver (Thin XA) for Instance connections; Versions: Any</strong>.</li>
<li>Click <em><strong>Next</strong></em>.</li>
<li>Click <em><strong>Next</strong></em> again.</li>
<li>Set the connection:</li>
</ol>
<ul>
<li>Database name, e.g.: bonita_db</li>
<li>Hostname, e.g.: localhost</li>
<li>Port, e.g.: 1521</li>
<li>Database user name, e.g.: bonita_db_user</li>
<li>Database password, e.g.: bonita_db_password</li>
</ul>
<ol start="10">
<li>Click <em><strong>Next</strong></em>.</li>
<li>Click <em><strong>Test Configuration</strong></em> to confirm that configuration is correct.</li>
<li>Click <em><strong>Next</strong></em>.</li>
<li>Select <strong>AdminServer</strong> to associate your datasource with the default server.</li>
<li>Click <strong><em>Finish</em></strong>.</li>
</ol>
<h3>bonitaSequenceManagerDS and NotManagedBizDataDS</h3>
<p>Follow this procedure to configure the bonitaSequenceManagerDS datasource, and (optionally) again to configure the NotManagedBizDataDS data source.</p>
<ol>
<li>Connect to <strong>WebLogic administration console</strong>.</li>
<li>In the tree menu on the left, go to <strong>Services / Data Sources</strong>.</li>
<li>Click New and select <strong>Generic Data Sources</strong>.</li>
<li>Set</li>
</ol>
<ul>
<li>The data source name: bonitaSequenceManagerDS (or NotManagedBizDataDS)</li>
<li>JDNI name: bonitaSequenceManagerDS (or NotManagedBizDataDS)</li>
<li>Database type: Oracle</li>
</ul>
<ol start="5">
<li>
<p>Click <em><strong>Next</strong></em>.</p>
</li>
<li>
<p>Select <strong>Oracle Driver (Thin) for Instance connections; Versions: Any</strong>. This data source does not need to be XA.</p>
</li>
<li>
<p>Click <strong><em>Next</em></strong>.</p>
</li>
<li>
<p>Uncheck <em><strong>Supports Global Transactions</strong></em>.</p>
</li>
<li>
<p>Click <strong><em>Next</em></strong>.</p>
</li>
<li>
<p>Set the connection:</p>
</li>
</ol>
<ul>
<li>Database name, e.g.: bonita_db</li>
<li>Hostname, e.g.: localhost</li>
<li>Port, e.g.: 1521</li>
<li>Database user name, e.g.: bonita_db_user</li>
<li>Database password, e.g.: bonita_db_password</li>
</ul>
<ol start="11">
<li>Click <em><strong>Next</strong></em>.</li>
<li>Click <em><strong>Test Configuration</strong></em> to confirm that configuration is correct.</li>
<li>Click <em><strong>Next</strong></em>.</li>
<li>Select <strong>AdminServer</strong> to associate your datasource with the default server.</li>
<li>Click <strong><em>Finish</em></strong>.</li>
</ol>
<h2>Bonita BPM platform</h2>
<ol>
<li>
<p>Download the deploy.zip file from the <a href="http://www.bonitasoft.com/downloads-v2">Bonitasoft site</a> for the Community edition
or from the <a href="https://customer.bonitasoft.com/download/request">Customer Portal</a> for Subscription editions.</p>
</li>
<li>
<p>Unzip the deploy bundle. The path to the unzipped deploy bundle will be referred to as ``</p>
</li>
<li>
<p>Create a new folder to store Bonita &quot;home&quot; folder. For the Community or Subscription edition, copy bonita &quot;home&quot; folder from deploy bundle folder
(<code>/bonita_home-x.y.z</code>) (where <code>x.y.z</code> is the version number) to the newly created folder.
The full path including <code>bonita_home-x.y.z</code>
will be referred as ``.</p>
</li>
<li>
<p>Edit <code>/engine-server/conf/platform/bonita-platform-community-custom.properties</code> and update the following properties:</p>
</li>
</ol>
<ul>
<li>database.journal.datasource.name=bonitaDS</li>
<li>database.sequence.manager.datasource.name=bonitaSequenceManagerDS</li>
<li>hibernate.transaction.jta_platform = org.hibernate.service.jta.platform.internal.WeblogicJtaPlatform</li>
<li>db.vendor=oracle</li>
<li>transaction.manager=java:comp/UserTransaction</li>
<li>userTransaction=java:comp/UserTransaction</li>
</ul>
<ol start="5">
<li>Edit <code>/engine-server/conf/tenants/template/bonita-tenant-sp-custom.properties</code> and update the following property:</li>
</ol>
<ul>
<li>database.journal.datasource.name=bonitaDS</li>
</ul>
<ol start="6">
<li>Edit <code>/engine-server/conf/tenants/tenant-template/bonita-tenant-community-custom.properties</code> and update the following properties:</li>
</ol>
<ul>
<li>bdm.db.vendor=oracle</li>
<li>bdm.datasource.jndi.path=BusinessDataDS</li>
<li>bdm.notmanageddatasource.jndi.path=NotManagedBizDataDS</li>
<li>bdm.hibernate.transaction.jta_platform=org.hibernate.service.jta.platform.internal.WeblogicJtaPlatform</li>
</ul>
<p>For each new tenant created, the structure will be as shown above.</p>
<ol start="7">
<li>Configure JVM system properties:</li>
</ol>
<ul>
<li>Edit <code>/user_projects/domains//bin/startWebLogic.sh</code> and set: <code>JAVA_OPTIONS=&quot;${SAVE_JAVA_OPTIONS} -Dbonita.home=&quot;</code></li>
</ul>
<ol start="8">
<li>Add the license file to your ``folder</li>
<li>Add SLF4J libraries (API and JDK back-end located in <code>/Tomcat-6.0.37/lib</code>) to bonita.war file to <code>WEB_INF/lib/</code>
(located in: <code>/Tomcat-6.0.37/webapps</code>).</li>
</ol>
<p>**Note:**To add a file to a WAR you can use a tool such as 7-zip or
command line: <code>jar uf bonita.war WEB-INF/lib/slf4j-api-1.6.1.jar</code>.</p>
<ol start="10">
<li>Check that the weblogic.xml descriptor is present in <code>bonita.war/WEB-INF</code> folder of the war.</li>
<li>Deploy Bonita war file, as follows:</li>
</ol>
<ul>
<li>Connect to WebLogic administration console.</li>
<li>In the tree menu on the left, go to <strong>Deployments</strong>.</li>
<li>Click the <em><strong>Install</strong></em> button.</li>
<li>Browse to the folder of your Deploy Bundle and deploy the bonita.war file provided for Tomcat.</li>
<li>Click <em><strong>Next</strong></em>.</li>
<li>Select <em><strong>Install this deployment as an application</strong></em>.</li>
<li>Click <em><strong>Next</strong></em>.</li>
<li>Keep the default settings.</li>
<li>Click <em><strong>Next</strong></em>.</li>
<li>Click <em><strong>Finish</strong></em>.</li>
</ul>
<h2>Check the installation</h2>
<ol>
<li>To verify that the installation was successful and the database is correctly configured, connect to Bonita BPM Portal.</li>
<li>In the URL field of your web browser, enter the host address, for example <code>http://localhost:7001/bonita&quot;&gt;http://localhost:7001/bonita</code>.</li>
</ol>
<p><strong>Note:</strong> If the Bonita BPM Portal login page is not displayed, <a href="http://www.wikihow.com/Clear-Your-Browser's-Cache">empty your browser cache</a> and then reload the page.</p>
<p>At this stage no organization information is loaded: only the technical user account exists.</p>
<h2>Log in as the Technical user</h2>
<p>Log in as the <strong>Technical user</strong> in order to create a new user with an Administrator profile.</p>
<p>Note: the Technical user has limited rights in Bonita BPM Portal and exists just to initialize the organization.</p>
<p>The default values for login and password are:</p>
<ul>
<li>Login = install</li>
<li>Password = install</li>
</ul>
<p>The login and password are read from the
<code>/engine-server/conf/tenants//bonita-tenant-community-custom.properties</code>file.</p>
<p>These settings are also located in client side configuration file <code>client/platform/conf/platform-tenant-config.properties</code>.</p>
<h2>Modify the Technical user login and password</h2>
<p>To modify the default Technical user/password, update the following files with the same values:</p>
<ul>
<li><code>engine-server/conf/tenants//bonita-tenant-community-custom.properties</code></li>
<li><code>client/platform/conf/platform-tenant-config.properties</code></li>
</ul>
<h2>Create an Administrator user</h2>
<p>Note: do not create a user or an administrator with the same login as the technical users (platform and tenant)</p>
<p>To create a user with the &quot;administrator&quot; profile:</p>
<ol>
<li>Log in to Bonita BPM Portal as the technical user.</li>
<li>Create a new user.</li>
<li>Go to <strong>Configuration</strong> /<strong>Profiles</strong>.</li>
<li>Select the <strong>Administrator</strong> profile.</li>
<li>Click on the <strong><em>More</em></strong> button (in the top right corner).</li>
<li>Under <strong>Users mapping</strong>, click on <strong><em>Add a user</em></strong>.</li>
<li>Select your user and click on the <strong><em>Add</em></strong> button. Log out as the Technical user and log back in as the newly created user with administrative rights.</li>
<li>Create <a href="/manage-user.md">users with the standard profile</a>.</li>
<li>You can add newly created users to the <strong>User</strong> (standard) profile or to a custom profile.</li>
</ol>
<h4>Information</h4>
<p>If you already have a system that stores information about end users, you can use it to create user accounts in Bonita BPM.</p>
<p>If you use an LDAP or Active Directory system, you can use the <a href="/ldap-synchronizer.md">LDAP synchronizer</a> to keep the Bonita BPM organization synchronized with it.</p>
