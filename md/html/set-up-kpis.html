<style type="text/css">/** https://gist.github.com/andyferra/2554919#file-github-css **/
body {
  font-family: Helvetica, arial, sans-serif;
  font-size: 14px;
  line-height: 1.6;
  padding-top: 10px;
  padding-bottom: 10px;
  background-color: white;
  padding: 30px; }

body > *:first-child {
  margin-top: 0 !important; }
body > *:last-child {
  margin-bottom: 0 !important; }

a {
  color: #4183C4; }
a.absent {
  color: #cc0000; }
a.anchor {
  display: block;
  padding-left: 30px;
  margin-left: -30px;
  cursor: pointer;
  position: absolute;
  top: 0;
  left: 0;
  bottom: 0; }

h1, h2, h3, h4, h5, h6 {
  margin: 20px 0 10px;
  padding: 0;
  font-weight: bold;
  -webkit-font-smoothing: antialiased;
  cursor: text;
  position: relative; }

h1:hover a.anchor, h2:hover a.anchor, h3:hover a.anchor, h4:hover a.anchor, h5:hover a.anchor, h6:hover a.anchor {
  background: url("../../images/modules/styleguide/para.png") no-repeat 10px center;
  text-decoration: none; }

h1 tt, h1 code {
  font-size: inherit; }

h2 tt, h2 code {
  font-size: inherit; }

h3 tt, h3 code {
  font-size: inherit; }

h4 tt, h4 code {
  font-size: inherit; }

h5 tt, h5 code {
  font-size: inherit; }

h6 tt, h6 code {
  font-size: inherit; }

h1 {
  font-size: 28px;
  color: black; }

h2 {
  font-size: 24px;
  border-bottom: 1px solid #cccccc;
  color: black; }

h3 {
  font-size: 18px; }

h4 {
  font-size: 16px; }

h5 {
  font-size: 14px; }

h6 {
  color: #777777;
  font-size: 14px; }

p, blockquote, ul, ol, dl, li, table, pre {
  margin: 15px 0; }

hr {
  background: transparent url("../../images/modules/pulls/dirty-shade.png") repeat-x 0 0;
  border: 0 none;
  color: #cccccc;
  height: 4px;
  padding: 0; }

body > h2:first-child {
  margin-top: 0;
  padding-top: 0; }
body > h1:first-child {
  margin-top: 0;
  padding-top: 0; }
  body > h1:first-child + h2 {
    margin-top: 0;
    padding-top: 0; }
body > h3:first-child, body > h4:first-child, body > h5:first-child, body > h6:first-child {
  margin-top: 0;
  padding-top: 0; }

a:first-child h1, a:first-child h2, a:first-child h3, a:first-child h4, a:first-child h5, a:first-child h6 {
  margin-top: 0;
  padding-top: 0; }

h1 p, h2 p, h3 p, h4 p, h5 p, h6 p {
  margin-top: 0; }

li p.first {
  display: inline-block; }

ul, ol {
  padding-left: 30px; }

ul :first-child, ol :first-child {
  margin-top: 0; }

ul :last-child, ol :last-child {
  margin-bottom: 0; }

dl {
  padding: 0; }
  dl dt {
    font-size: 14px;
    font-weight: bold;
    font-style: italic;
    padding: 0;
    margin: 15px 0 5px; }
    dl dt:first-child {
      padding: 0; }
    dl dt > :first-child {
      margin-top: 0; }
    dl dt > :last-child {
      margin-bottom: 0; }
  dl dd {
    margin: 0 0 15px;
    padding: 0 15px; }
    dl dd > :first-child {
      margin-top: 0; }
    dl dd > :last-child {
      margin-bottom: 0; }

blockquote {
  border-left: 4px solid #dddddd;
  padding: 0 15px;
  color: #777777; }
  blockquote > :first-child {
    margin-top: 0; }
  blockquote > :last-child {
    margin-bottom: 0; }

table {
  padding: 0; }
  table tr {
    border-top: 1px solid #cccccc;
    background-color: white;
    margin: 0;
    padding: 0; }
    table tr:nth-child(2n) {
      background-color: #f8f8f8; }
    table tr th {
      font-weight: bold;
      border: 1px solid #cccccc;
      text-align: left;
      margin: 0;
      padding: 6px 13px; }
    table tr td {
      border: 1px solid #cccccc;
      text-align: left;
      margin: 0;
      padding: 6px 13px; }
    table tr th :first-child, table tr td :first-child {
      margin-top: 0; }
    table tr th :last-child, table tr td :last-child {
      margin-bottom: 0; }

img {
  max-width: 100%; }

span.frame {
  display: block;
  overflow: hidden; }
  span.frame > span {
    border: 1px solid #dddddd;
    display: block;
    float: left;
    overflow: hidden;
    margin: 13px 0 0;
    padding: 7px;
    width: auto; }
  span.frame span img {
    display: block;
    float: left; }
  span.frame span span {
    clear: both;
    color: #333333;
    display: block;
    padding: 5px 0 0; }
span.align-center {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-center > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: center; }
  span.align-center span img {
    margin: 0 auto;
    text-align: center; }
span.align-right {
  display: block;
  overflow: hidden;
  clear: both; }
  span.align-right > span {
    display: block;
    overflow: hidden;
    margin: 13px 0 0;
    text-align: right; }
  span.align-right span img {
    margin: 0;
    text-align: right; }
span.float-left {
  display: block;
  margin-right: 13px;
  overflow: hidden;
  float: left; }
  span.float-left span {
    margin: 13px 0 0; }
span.float-right {
  display: block;
  margin-left: 13px;
  overflow: hidden;
  float: right; }
  span.float-right > span {
    display: block;
    overflow: hidden;
    margin: 13px auto 0;
    text-align: right; }

code, tt {
  margin: 0 2px;
  padding: 0 5px;
  white-space: nowrap;
  border: 1px solid #eaeaea;
  border-radius: 3px; }

pre code {
  margin: 0;
  padding: 0;
  white-space: pre;
  border: none;
  background: transparent; }

pre {
  background-color: #073642;
  color: #f8f8f8;
  border: 1px solid #cccccc;
  font-size: 13px;
  line-height: 19px;
  overflow: auto;
  padding: 6px 10px;
  border-radius: 3px; }
  pre code, pre tt {
    background-color: transparent;
    border: none; }

</style><link rel="stylesheet" href="http://yandex.st/highlightjs/8.0/styles/solarized_dark.min.css">
<h1 id="1-10-3-set-up-kpis">1.10.3 Set up KPIs</h1>
<p>This page presents two implementation options for creating KPIs and integrating them to business processes:</p>
<ul>
<li><p><a href="#using_kpi">Create a KPI using the Bonita BPM Studio KPI feature</a></p>
<ul>
<li><a href="#create_kpi_definition">Create a KPI Definition</a></li>
<li><a href="#attach_kpi_definition">Attach a KPI Definition to a task or a pool</a></li>
<li><a href="#add_jdbc_driver">Configure the JDBC driver as a process dependency</a></li>
</ul>
</li>
<li><p><a href="#using_connector">Create a KPI using a database connector</a></p>
</li>
</ul>
<h2 id="create-a-kpi-using-the-bonita-bpm-studio-kpi-feature">Create a KPI using the Bonita BPM Studio KPI feature</h2>
<p>This implementation option is preferred if you do not wish to manipulate database connection settings and SQL queries manually when writing your KPI data. 
The Bonita BPM Studio assists you in setting your connection and automatically generates the SQL insertion queries for you.</p>
<p>Keep in mind that this implementation option has some drawbacks:</p>
<ul>
<li>You can only insert one row at a time. There is no dynamic multi-row insert.</li>
<li>You do not benefit from pooled database connections. This has an impact on performance.</li>
</ul>
<p>In order to use the KPI feature, you need to:</p>
<ol>
<li>Create a KPI definition</li>
<li>Attach the KPI definition to a task or to a pool</li>
<li>Configure the JDBC driver as a process dependency</li>
</ol>
<h3 id="create-a-kpi-definition">Create a KPI definition</h3>
<p>When creating a KPI definition, you must specify its database connection settings and its structure.</p>
<ol>
<li>In Bonita BPM Studio, open the <strong>KPI</strong> menu and select <strong>Create KPI</strong>.</li>
<li><p>Fill in the database JDBC connection settings:</p>
<ol>
<li>Choose the <em>Driver template</em> that matches your reporting database type:<br><img src="images/images-6_0/generic_driver.png" alt="JDBC driver templates"></li>
<li>Click on the <strong><em>Apply template</em></strong> button. This pre-fills the <em>Driver class name</em> and <em>JDBC URL</em> fields.</li>
<li>Update the configuration with your database name, user name, and password:<br><img src="images/images-6_0/createKPI_step4.png" alt="JDBC connection settings"></li>
<li>Click on <strong><em>Test connection</em></strong> to validate your settings.</li>
<li>Click on <strong><em>Next</em></strong>.</li>
</ol>
</li>
<li><p>Fill in the KPI Definition page</p>
<ol>
<li>Provide a name for the KPI definition. This is used as a reference for the Bonita BPM Studio developers.</li>
<li>Click on the <strong><em>Fetch tables</em></strong> button to select the table to which you wish to attach this KPI. 
This pre-fills the KPI fields based on your database structure. Alternatively, you can type the name of the database table.</li>
<li>Optionally, specify a description (for documentation purpose only).</li>
<li>Add/remove or update your KPI fields by specifying:<ul>
<li>the name (database column name)</li>
<li>the SQL type as defined in the database</li>
<li>whether the values should be surrounded with quotes in the SQL insertion query
<img src="images/images-6_0/editKPI.png" alt="KPI fields"></li>
</ul>
</li>
<li>Click on <strong><em>Create</em></strong>.</li>
</ol>
</li>
</ol>
<h3 id="attach-a-kpi-definition-to-a-task-or-a-pool">Attach a KPI Definition to a task or a pool</h3>
<p>Once you have specified a KPI Definition, you may to attach it multiple times and at different levels:</p>
<ul>
<li><em>Pool level</em> - This generates KPI data either at process start or end</li>
<li><em>Task level</em> - This generates KPI data either at task start or end</li>
</ul>
<p>Follow these instructions to attach a KPI:</p>
<ol>
<li>In Bonita BPM Studio, either select a task or a process pool.</li>
<li>In the <strong>Details</strong> panel, <strong>Execution</strong> tab, <strong>KPIs</strong> pane, click on the <strong><em>Add</em></strong> button.</li>
<li>Select your KPI Definition from the list</li>
<li>Click on <strong><em>Next</em></strong>.</li>
<li>Review your database connection settings and test your connection (these are imported from your KPI definition so they should be correct).</li>
<li>Click on <strong><em>Next</em></strong>.</li>
<li><p>Fill in the Advanced configuration page</p>
<ol>
<li>Make sure the <strong>Database table</strong> name is correct (this field is preloaded from your KPI Definition so it should be correct).</li>
<li>Select the <strong>Error behavior</strong> if KPI generation fails: you can either put the process into an error state, or ignore the failure.</li>
<li>Pick a KPI insertion event relative to the object to which you are attaching the KPI (task or pool).</li>
<li>Select an <strong>Edition mode</strong> for the insertion query. <strong>Graphical mode</strong> benefits from the mapping that you have provided in the KPI Definition,
<strong>Manual mode</strong> will let you write an SQL query.</li>
</ol>
</li>
<li><p>Assuming that you have chosen the <strong>Graphical mode</strong> and clicked on <strong><em>Next</em></strong>, then configure the KPI field mapping.</p>
</li>
<li><p>Add as many rows as there are KPI fields in your Definition. For each row:</p>
<ul>
<li>Expand the drop-down menu and choose a KPI field from your Definition.</li>
<li>Specify its value with an expression (a constant, a parameter, or a variable).</li>
</ul>
</li>
<li><p>Click on <strong><em>Finish</em></strong>.</p>
</li>
</ol>
<h3 id="configure-the-jdbc-driver-as-a-process-dependency">Configure the JDBC driver as a process dependency</h3>
<p>When your KPIs are attached to your process, add a JDBC driver dependency to your process.</p>
<ol>
<li>In Bonita BPM Studio, select your process pool and click on <strong><em>Configure</em></strong> in the coolbar.</li>
<li>Select <strong>Process dependencies</strong> from the list on the left.</li>
<li>Check the .jar file of the JDBC driver that matches your reporting database.</li>
<li>Click on <strong><em>Finish</em></strong>.</li>
</ol>
<p>Your process is now ready to be deployed. 
Reporting data will be generated in the reporting database each time the KPIs are triggered.</p>
<h2 id="create-a-kpi-using-a-database-connector">Create a KPI using a database connector</h2>
<p>This implementation option is preferred for performance and flexibility reasons:</p>
<ul>
<li>It enables dynamic multi-row insertions, because you can use Groovy scripts to transform data and generate complex queries.</li>
<li>It benefits from pooled database connections for improved performances.</li>
</ul>
<p>The disadvantage with this implementation option is that it requires basic SQL knowledge because you have to write insertion queries manually.</p>
<p>To configure this option, use a <a href="/product-bos-sp/database">database connector</a> to insert a row in the reporting database.</p>
<p>Use the datasource database connector with connection pooling for improved performance.<script src="http://yandex.st/highlightjs/8.0/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script></p>
